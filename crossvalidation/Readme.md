# Cross validation
The code here is capable of allowing you to fine-tune your hyperparameters for your model. MatLab provides cross-validation code only for certain classifiers that it provides. If you are interested in working on your code this might help.
[Code Walkthrough Video](https://www.youtube.com/watch?v=Y1i04pzAwBc "Cross-Validation code walkthrough")
## Cross-validation code for MATLAB (files required: crossvalidation.m blocking.m)
### function signature for crossvalidation
`function[optpara] = crossvalidation(foldabledata,otherpara,parameterlist,train_func,test_func, prfrmncePara,fold)`

   input parameter information for crossvalidation
1. `foldabledata`: An array of size (1 x Number of Classes), at each index a 2-dim array of input samples having features and the target value is kept in the structure's data member `data`
   
   Example: `foldabledata(1).data=[rand(100,4) 2*ones(100,1)]`
  
3. `fold`: parameter k of k-fold cross-validation
   
   Example: `fold=5` for 5-fold cross-validation

4. `parameterlist`: An array of structures of parameters. The optimal value of these parameters needs to be found by grid search over all possible combinations of the parameter values using k-fold cross-validation by minimising val.err
   
   Example: `parameterlist(1).values = [1,2,3]; parameterlist(2).values = [4,7,8,3];`

5. `otherpara`: structure having all other required parameters be passed to trainfunc or testfunc functions. These parameters do not play any role in cross-validation. These will be passed exactly in the same way. 

6. `train_func`: handle to train function returns out structure which will be feeded to testfunc. out structure keeps all the information generated during training the model and is required to generate predictions.
    1. The train_func should follow following prototype:
       
       `[Mdl] = train_func(trainfold,otherpara,parameter)`

       input parameters for train_func
    3. `trainfold`: is exactly of the same type as that of `foldabledata`
    4. `otherpara`: same as that of `otherpara `of `crossvalidation`
    5. `parameter`: is an 1D array of hyperparameter values. Each index has one value of corresponding parameter.
   
       Example: `parameter = [parameterlist(1).value(1), parameterlist(2).value(1),...]`          

       output parameters for train_func
    7. `Mdl`: A structure containing all the information generated by train_func but required by the prediction function to generate a prediction on a given test sample. 

7. `test_func`: handle to predict function, returns structure containing an PC field, considered for predicted value and act field for actual target values.
      1. It should have following prototype

        `[res] = test_func(trainfold,testfold,parameter,Mdl,otherpara);`

        input parameters for test_func
      2. `trainfold, testfold`: has same structure as that of `foldabledata`
      3. `parameter`: is an array of hyperparameter values. The order will be exactly the same as that of parameterlist,
     
        Example: `parameter = [parameterlist(1).value(1), parameterlist(2).value(1),...]`
      5. `Mdl`: An structure containing all the information generated by train_func but required by prediction function to generate prediction on a given test sample. 
      6. `otherpara`: same as that of `otherpara `of cross-validation

         output parameters for test_func
      7. `res`: is a structure with two fields.
         * `res.act `for the actual value of the target variable and
         * `res.PC `for the predicted value of the target variable.

8. `prfrmncePara`: handle to performance parameter evaluation function on  the lower value of which hyperparameter is tuned. It should output a structure with an attribute `err `treated as error.
      1. It should have following prototype:
  
         `[val] = prfrmncePara(act,PC)`

         input parameters for prfrmncePara
      3. `act` for the actual value of the target variable and 
      2. `PC` for the predicted value of the target variable.

          output parameters for prfrmncePara
      4. `val` is a structure with `err` as one of the attribute. Hyperparameters will be chosen by minimising this value 

  Output parameter information for crossvalidation
  
8. `optpara.parameter` - structure that keeps parameter values asked to be tuned for
9. `optpara.error` -structure that keeps values of error corresponding to each specific set of parameter values asked to tuned for 

## Author Information
Author: Kapil

Affiliation: Department of Computer Applications, NIT Kurukshetra

Email: kapil@nitkkr.ac.in
